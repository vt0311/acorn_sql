SELECT DRUG_INGREDIENT_CODE, count(DRUG_INGREDIENT_CODE) FROM DRUG_2014 where drug_ingredient_code in (
'101601APD',
'101601APD',
'101601APD',
'101601APD',
'101601APD',
'101601APD',
'101601APD',
'101601APD',
'101601ATB',
'101601ATB',
'101601ATB',
'101601ATE',
'101601ATB',
'101601ATB',
'101601ATB',
'101601ATB',
'101601ATB',
'101601ATB',
'101601ATB',
'101601ATB',
'101601ATB',
'101601ATB',
'101601ATB',
'101601ATB',
'101601ATB',
'101601ATB',
'101601ATB',
'101601ATB',
'101601ATB',
'101601ATB',
'101601ATB',
'101601ATB',
'101601ATB',
'101601ATB',
'101601ATB',
'101601ATB',
'101601ATB',
'101601ATB',
'101601ATE',
'101601ATE',
'101601ATE',
'101601ATB',
'101601ATB',
'101601ATB',
'101601ATB',
'101601ATB',
'101601ATB',
'101601ATB',
'101601ATB',
'101601ATB',
'107501ATB',
'107501ATB',
'107501ATB',
'107502ATB',
'107502ATB',
'108001ATB',
'108002ATB',
'136301ACH',
'136302ACH',
'136302ACH',
'148601ATB',
'148601ATB',
'148601ATB',
'148601ATB',
'148601ATB',
'148601ATB',
'148601ATB',
'148601ATB',
'148601ATB',
'148601ATB',
'148601ATB',
'148601ATB',
'148601ATB',
'148601ATB',
'148601ATB',
'148601ATB',
'148601ATB',
'148601ATB',
'148601ATB',
'148601ATB',
'148601ATB',
'148601ATB',
'148601ATB',
'148601ATB',
'148601ATB',
'148601ATB',
'148601ATB',
'148601ATB',
'148601ATB',
'148601ATB',
'148601ATB',
'148601ATB',
'148601ATB',
'148601ATB',
'148601ATB',
'148601ATB',
'148601ATB',
'148601ATB',
'148601ATB',
'148601ATD',
'148601ATD',
'148601ATD',
'148601ATD',
'148601ATD',
'148601ATD',
'148601ATD',
'148602ATB',
'148602ATB',
'148602ATB',
'148602ATB',
'148602ATB',
'148602ATB',
'148602ATB',
'148602ATB',
'148602ATB',
'148602ATB',
'148602ATB',
'148602ATB',
'148602ATB',
'148602ATB',
'148602ATB',
'148602ATB',
'148602ATB',
'148602ATB',
'148602ATB',
'148602ATB',
'148602ATB',
'148602ATB',
'148602ATB',
'148602ATB',
'148602ATB',
'148602ATB',
'148602ATB',
'148602ATB',
'148602ATB',
'148602ATB',
'148602ATB',
'148602ATB',
'148602ATB',
'148602ATB',
'148602ATB',
'148602ATB',
'148602ATD',
'148602ATD',
'148602ATD',
'148602ATD',
'148602ATD',
'148602ATD',
'148602ATD',
'148901ACH',
'148901ACH',
'149901ATB',
'149901ATB',
'149901ATB',
'149901ATB',
'161501ACH',
'161501ACH',
'161501ACH',
'161501ACH',
'161501ACH',
'161501ACH',
'161501ACH',
'161502ACH',
'161502ACH',
'161502ACH',
'161502ATB',
'161502ACH',
'161502ACH',
'161502ACH',
'161502ACH',
'161502ACH',
'161502ACH',
'161502ACH',
'161502ACH',
'161502ACH',
'161502ACH',
'161502ACH',
'161502ACH',
'161502ACH',
'161502ACH',
'161502ACH',
'161502ACH',
'161502ACH',
'161502ACH',
'161502ACH',
'161502ACH',
'161502ACH',
'161502ACH',
'161502ACH',
'161502ACH',
'161502ACH',
'161502ACH',
'161502ACH',
'161502ACH',
'161502ACH',
'161502ACH',
'161502ACH',
'161502ATR',
'161502ATR',
'161502ATR',
'161504ACR',
'162501ATB',
'162502ATB',
'165301ACS',
'165301ACS',
'165301ATB',
'165301ATB',
'165301ATB',
'165301ATB',
'165301ATB',
'165301ACS',
'165301ATB',
'165303ALQ',
'165303ATB',
'165303ATB',
'165303ATB',
'165303ATB',
'165303ATB',
'165303ATB',
'165303ACS',
'165303ATB',
'165303ATB',
'165303ATB',
'165303ATB',
'165303ATB',
'165303ATB',
'165303ATB',
'165303ATB',
'165303ATB',
'165303ACS',
'165303ATB',
'165303ACS',
'165303ATB',
'165303ATB',
'165303ACS',
'165303ATB',
'165303ATB',
'165303ATB',
'165304ATB',
'165305ALQ',
'165305ATB',
'165305ATB',
'165305ATB',
'165305ATB',
'165305ATB',
'165305ATB',
'165305ATB',
'165305ATB',
'165305ATB',
'165305ATB',
'165305ATB',
'165305ATB',
'165305ATB',
'172601ATB',
'172601ATB',
'173701ATB',
'173701ATB',
'173701ATB',
'190001ALQ',
'190001ALQ',
'190001ALQ',
'190001ATB',
'190001ATB',
'190001ATB',
'190001ATB',
'190001ATB',
'190001ATB',
'190001ATB',
'190001ATB',
'190001ATB',
'190001ATB',
'190001ATB',
'190001ATB',
'190001ATB',
'190001ATB',
'190001ATB',
'190001ATB',
'190002ASY',
'193201ATB',
'193201ATB',
'193201ATB',
'193201ACR',
'193202ATB',
'193203ATR',
'193205ACR',
'193206ATR',
'193207ACR',
'196201ATB',
'196201ATB',
'196201ATD',
'196201ATD',
'196201ATD',
'196202ATB',
'196202ATD',
'196202ATD',
'196202ATD',
'196701ATB',
'203401ATB',
'203402ATB',
'206501ASY',
'206503ATB',
'206503ATB',
'206503ATB',
'206503ATB',
'206503ATB',
'206503ATB',
'206503ATB',
'206503ATB',
'206503ATB',
'206503ATB',
'206503ATB',
'206503ATB',
'206503ATB',
'206504ATB',
'206504ATB',
'209301ATB',
'209301ATB',
'209302ATB',
'209302ATB',
'209302ATB',
'209302ATB',
'209302ATB',
'209302ATB',
'209302ATB',
'209304ATE',
'209304ATE',
'209304ATE',
'209304ATE',
'209304ATE',
'209304ATE',
'209304ATE',
'209305ATE',
'209305ATE',
'213403ACH',
'213403ACH',
'213405ATB',
'213405ATB',
'213405ATB',
'222101ATB',
'222101ATB',
'224501ACH',
'224503ACH',
'224504ACH',
'224505ACH',
'227001ATB',
'227001ATB',
'227001ATB',
'227001ATB',
'229601ATB',
'242901ACH',
'242901ACH',
'242901ACH',
'242901ATB',
'242902ATB',
'242903ATR',
'247502ACR',
'247502ACR',
'247502ACR',
'247502ACR',
'247502ACR',
'247502ACR',
'247502ACR',
'247502ACR',
'247502ACR',
'247502ACR',
'247502ACR',
'247502ACR',
'247502ACR',
'247502ACR',
'247502ATR',
'247502ACR',
'247504ACR',
'247504ACR',
'247504ACR',
'247504ACR',
'247504ACR',
'247504ACR',
'247504ACR',
'247504ACR',
'247504ATR',
'247504ACR',
'355801ACH',
'355802ACH',
'385203ACR',
'385203ATR',
'385203ACR',
'385204ACR',
'385204ACR',
'385204ACR',
'385204ATR',
'385204ACR',
'385205ACR',
'385205ATR',
'385205ACR',
'428101ATB',
'428102ATR',
'428102ATR',
'428102ATR',
'428103ATR',
'428301ATB',
'439502ATB',
'461601ATB',
'474801ATB',
'474801ATB',
'474801ATB',
'474801ATB',
'474801ATB',
'474802ATB',
'474802ATB',
'474802ATB',
'474802ATB',
'474802ATB',
'474802ATB',
'474802ATB',
'474802ATB',
'474802ATB',
'474802ATB',
'474802ATB',
'474802ATB',
'474802ATB',
'474802ATB',
'474802ATB',
'474802ATB',
'474802ATB',
'474802ATB',
'474802ATB',
'474802ATB',
'474802ATB',
'474802ATB',
'474802ATB',
'474802ATB',
'474802ATB',
'474802ATB',
'474802ATB',
'474802ATB',
'474802ATB',
'474802ATB',
'474802ATB',
'474802ATB',
'474802ATB',
'474803ATB',
'489601ACH',
'489602ACH',
'489603ACH',
'489604ACH',
'489605ACH',
'489606ACH',
'495501ACH',
'495502ACH'
)
group by DRUG_INGREDIENT_CODE
order by count(DRUG_INGREDIENT_CODE) desc;

SELECT * FROM DRUG_2014 where drug_ingredient_code = '224201ATB';


SELECT * FROM DRUG_2014 where drug_ingredient_code = '165305ATB';

DROP TABLE GNL_NM_CD_ALL;

create table GNL_NM_CD_ALL(
    "SIKYAK_BUNRYU" VARCHAR2(20 BYTE), 
	"DRUG_INGREDIENT_CODE" VARCHAR2(20 BYTE), 
    "ATC_CODE" VARCHAR2(20 BYTE), 
    "NEW_CODE" VARCHAR2(20 BYTE), 
	"INGREDIENT_NAME" VARCHAR2(200 BYTE), 
	"PRODUCT_NAME" VARCHAR2(200 BYTE), 
    "PRODUCT_COMPANY" VARCHAR2(200 BYTE), 
	"JEONIL" VARCHAR2(200 BYTE)
    );
    
    SELECT * FROM GNL_NM_CD_ALL;
    
    SELECT A.DRUG_INGREDIENT_CODE, COUNT(A.DRUG_INGREDIENT_CODE) FROM DRUG_2014 A, GNL_NM_CD_ALL B 
    WHERE A.DRUG_INGREDIENT_CODE = B.DRUG_INGREDIENT_CODE
    GROUP BY A.DRUG_INGREDIENT_CODE
    order by count(DRUG_INGREDIENT_CODE) desc;

DROP TABLE BARCODEDATA;    

create table barCodeData(
    "PRODUCT_NAME" VARCHAR2(500 BYTE), 
	"COMPANY_NAME" VARCHAR2(200 BYTE), 
    "DRUG_STD" VARCHAR2(200 BYTE), 
    "QTY" VARCHAR2(200 BYTE), 
	"DOSAGE_TYPE" VARCHAR2(200 BYTE), 
	"PACKING_TYPE" VARCHAR2(200 BYTE), 
    "PRODUCT_STD_CD" VARCHAR2(200 BYTE), 
	"PERMISSION_DATE" VARCHAR2(200 BYTE),
    "NORMAL_OR_SPECIAL" VARCHAR2(200 BYTE), 
    "REPRESENT_CD" VARCHAR2(200 BYTE),  
    "STD_CD" VARCHAR2(200 BYTE),  
    "NEW_CD" VARCHAR2(200 BYTE),  
    "DRUG_INGREDIENT_CODE" VARCHAR2(200 BYTE),
    "MEMO" VARCHAR2(2000 BYTE),
    "CANCEL_DATE" VARCHAR2(200 BYTE),
    "TRANSFER_START_DATE" VARCHAR2(200 BYTE),
    "TRANSFER_END_DATE" VARCHAR2(200 BYTE),
    "SERIAL_YN" VARCHAR2(100 BYTE),
    "SERIAL_REASON" VARCHAR2(200 BYTE),
    "ATC_CD" VARCHAR2(50 BYTE),
    "SPECIAL_CARE" VARCHAR2(200 BYTE),
    "DECODE" VARCHAR2(200 BYTE)
    );    
    
    SELECT COUNT(*) FROM BARCODEDATA;
    -- 
    SELECT COUNT(*) FROM (
    SELECT USER_ID, COUNT(USER_ID) FROM DRUG_2014 GROUP BY  USER_ID);
    
    -- 194703 개
    SELECT COUNT(*) FROM BARCODEDATA;
    
    SELECT * FROM AAA;
    
    DROP TABLE AAA;
    
    SELECT * FROM ASDF;
    
    SELECT COUNT(*) FROM DRUG_2014;
    
    ALTER TABLE ASDF RENAME COLUMN ID TO NAME;
    
    ALTER TABLE BARCODEDATA RENAME COLUMN FIGURE_TYPE TO DOSAGE_TYPE; 
    
      ALTER TABLE BARCODEDATA RENAME COLUMN FIGURE_TYPE TO DOSAGE_TYPE; 
      
      ALTER TABLE BARCODEDATA MODIFY(DRUG_STD VARCHAR2(200 BYTE ));
      
 CREATE TABLE DRUG_2015 (
    "BASE_YEAR" NUMBER(4,0), 
	"USER_ID" NUMBER(10,0), 
	"PRES_ID" NUMBER(10,0), 
	"SERIAL_NUM" NUMBER(3,0), 
	"SEX" NUMBER(1,0), 
	"AGE_CODE" NUMBER(2,0), 
	"SIDO_CODE" NUMBER(2,0), 
	"RECUPERATE_DATE" VARCHAR2(20 BYTE), 
	"DRUG_INGREDIENT_CODE" VARCHAR2(20 BYTE), 
	"DOSE_ONCE" FLOAT(126), 
	"DOSE_ONEDAY" NUMBER(2,0), 
	"DOSE_DAYS" NUMBER(4,0), 
	"UNIT_COST" NUMBER(6,0), 
	"PRICE" NUMBER(10,0)
 );
 
 CREATE TABLE DRUG_2015 (
    "BASE_YEAR" NUMBER(4,0), 
	"USER_ID" NUMBER(10,0), 
	"PRES_ID" NUMBER(10,0), 
	"SERIAL_NUM" NUMBER(3,0), 
	"SEX" NUMBER(1,0), 
	"AGE_CODE" NUMBER(2,0), 
	"SIDO_CODE" NUMBER(2,0), 
	"RECUPERATE_DATE" VARCHAR2(20 BYTE), 
	"DRUG_INGREDIENT_CODE" VARCHAR2(20 BYTE), 
	"DOSE_ONCE" FLOAT(126), 
	"DOSE_ONEDAY" NUMBER(2,0), 
	"DOSE_DAYS" NUMBER(4,0), 
	"UNIT_COST" NUMBER(6,0), 
	"PRICE" NUMBER(10,0)
 );
 
 --DELETE FROM DRUG_2015; 
 
 -- 29470145
 select count(*) from (
 SELECT * FROM DRUG_2015
 union all
 select * from drug_2015_2); 
 
  -- 29470145
 select count(*) from (
 SELECT * FROM DRUG_2015
 union 
 select * from drug_2015_2); 
 
 
  SELECT COUNT(*) FROM DRUG_2015; 
  
  -- DRUG_2015에서 ATC CODE 가 N06A만 뽑는 쿼리  
    SELECT A.DRUG_INGREDIENT_CODE, COUNT(A.DRUG_INGREDIENT_CODE) FROM 
            (SELECT DRUG_INGREDIENT_CODE FROM DRUG_2015 UNION ALL SELECT DRUG_INGREDIENT_CODE FROM DRUG_2015_2 ) A, BARCODEDATA B 
    WHERE A.DRUG_INGREDIENT_CODE = B.DRUG_INGREDIENT_CODE
    AND B.ATC_CD like 'N06A%'
    GROUP BY A.DRUG_INGREDIENT_CODE
    order by count(DRUG_INGREDIENT_CODE) desc;
    
    -- DRUG_2014에서 ATC CODE 가 N06A만 뽑는 쿼리  
    SELECT A.DRUG_INGREDIENT_CODE, COUNT(A.DRUG_INGREDIENT_CODE) FROM 
            (SELECT DRUG_INGREDIENT_CODE FROM DRUG_2014_1 UNION ALL SELECT DRUG_INGREDIENT_CODE FROM DRUG_2014_2 ) A, BARCODEDATA B 
    WHERE A.DRUG_INGREDIENT_CODE = B.DRUG_INGREDIENT_CODE
    AND B.ATC_CD like 'N06A%'
    GROUP BY A.DRUG_INGREDIENT_CODE
    order by count(DRUG_INGREDIENT_CODE) desc;
    
     -- DRUG_2013에서 ATC CODE 가 N06A만 뽑는 쿼리  
    SELECT A.DRUG_INGREDIENT_CODE, COUNT(A.DRUG_INGREDIENT_CODE) FROM 
            DRUG_2013 A, BARCODEDATA B 
    WHERE A.DRUG_INGREDIENT_CODE = B.DRUG_INGREDIENT_CODE
    AND B.ATC_CD like 'N06A%'
    GROUP BY A.DRUG_INGREDIENT_CODE
    order by count(DRUG_INGREDIENT_CODE) desc;
    
     -- DRUG_2012에서 ATC CODE 가 N06A만 뽑는 쿼리  
    SELECT A.DRUG_INGREDIENT_CODE, COUNT(A.DRUG_INGREDIENT_CODE) FROM 
            DRUG_2012 A, BARCODEDATA B 
    WHERE A.DRUG_INGREDIENT_CODE = B.DRUG_INGREDIENT_CODE
    AND B.ATC_CD like 'N06A%'
    GROUP BY A.DRUG_INGREDIENT_CODE
    order by count(DRUG_INGREDIENT_CODE) desc;
    
    -- DRUG_2011에서 ATC CODE 가 N06A만 뽑는 쿼리  
    SELECT A.DRUG_INGREDIENT_CODE, COUNT(A.DRUG_INGREDIENT_CODE) FROM 
            DRUG_2011 A, BARCODEDATA B 
    WHERE A.DRUG_INGREDIENT_CODE = B.DRUG_INGREDIENT_CODE
    AND B.ATC_CD like 'N06A%'
    GROUP BY A.DRUG_INGREDIENT_CODE
    order by count(DRUG_INGREDIENT_CODE) desc;
    
    -- DRUG_2015에서 ATC CODE 가 N06A만 뽑는 쿼리 갯수
    SELECT COUNT(*) FROM (
    SELECT A.DRUG_INGREDIENT_CODE, COUNT(A.DRUG_INGREDIENT_CODE) FROM DRUG_2015 A, BARCODEDATA B 
    WHERE A.DRUG_INGREDIENT_CODE = B.DRUG_INGREDIENT_CODE
    AND B.ATC_CD like 'N06A%'
    GROUP BY A.DRUG_INGREDIENT_CODE
    order by count(DRUG_INGREDIENT_CODE) desc);
    
    
    
    -- DRUG_2015에서 ATC CODE 가 N06A만 뽑는 쿼리  
    SELECT * FROM 
            DRUG_2013 A, BARCODEDATA B 
    WHERE A.DRUG_INGREDIENT_CODE = B.DRUG_INGREDIENT_CODE
    AND B.ATC_CD like 'N06A%';
    --GROUP BY A.DRUG_INGREDIENT_CODE
    --order by count(DRUG_INGREDIENT_CODE) desc;
    
    SELECT COUNT(*) FROM (
     SELECT * FROM 
            DRUG_2013 A, BARCODEDATA B 
    WHERE A.DRUG_INGREDIENT_CODE = B.DRUG_INGREDIENT_CODE
    AND B.ATC_CD like 'N06A%');
    
    SELECT * FROM BARCODEDATA;
    
    SELECT COUNT(*) FROM (
     SELECT PRODUCT_NAME FROM BARCODEDATA WHERE DRUG_INGREDIENT_CODE IS NULL GROUP BY PRODUCT_NAME) ; 
    
    SELECT COUNT(*) FROM BARCODEDATA WHERE DRUG_INGREDIENT_CODE IS NULL; 
    
      SELECT * FROM BARCODEDATA WHERE DRUG_INGREDIENT_CODE IS NULL; 
      
      -- 갯수
      SELECT COUNT(*) FROM (
      SELECT * FROM
        (SELECT * FROM DRUG_2012 
        UNION ALL
         SELECT * FROM DRUG_2013
         UNION ALL
          SELECT * FROM DRUG_2014_1
          UNION ALL
           SELECT * FROM DRUG_2014_2
            UNION ALL
            SELECT * FROM DRUG_2015
            UNION ALL
            SELECT * FROM DRUG_2015_2) A,
       (SELECT * FROM BARCODEDATA WHERE aTC_CD LIKE 'N06A%' AND DRUG_INGREDIENT_CODE IS NOT NULL) B
        WHERE A.DRUG_INGREDIENT_CODE = B.DRUG_INGREDIENT_CODE )
       ;
       
       -- 2012 ~ 2015년 프로젝트 테이블  
        SELECT * FROM
        (SELECT * FROM DRUG_2012 
        UNION ALL
         SELECT * FROM DRUG_2013
         UNION ALL
          SELECT * FROM DRUG_2014_1
          UNION ALL
           SELECT * FROM DRUG_2014_2
            UNION ALL
            SELECT * FROM DRUG_2015
            UNION ALL
            SELECT * FROM DRUG_2015_2) A,
       (SELECT "PRODUCT_NAME" , 
	"COMPANY_NAME" ,
    "DRUG_STD" , 
    "QTY" ,
	"DOSAGE_TYPE" , 
	"PACKING_TYPE" ,
    "PRODUCT_STD_CD" ,
	"PERMISSION_DATE" ,
    "NORMAL_OR_SPECIAL" ,
    "REPRESENT_CD" , 
    "STD_CD",
    "NEW_CD" ,  
    "DRUG_INGREDIENT_CODE" ,
    "CANCEL_DATE",
    "TRANSFER_START_DATE" ,
    "TRANSFER_END_DATE" ,
    "SERIAL_YN" ,
    "SERIAL_REASON" ,
    "ATC_CD" ,
    "SPECIAL_CARE" ,
    "DECODE"  FROM BARCODEDATA WHERE aTC_CD LIKE 'N06A%' AND DRUG_INGREDIENT_CODE IS NOT NULL) B
        WHERE A.DRUG_INGREDIENT_CODE = B.DRUG_INGREDIENT_CODE ;
        
    /*    
     BASE_YEAR ,
	USER_ID ,
	PRES_ID ,
	SERIAL_NUM ,
	SEX ,
	AGE_CODE ,
	SIDO_CODE ,
	RECUPERATE_DATE ,
	DRUG_INGREDIENT_CODE ,
	DOSE_ONCE ,
	DOSE_ONEDAY ,
	DOSE_DAYS ,
	UNIT_COST ,
	PRICE */
    
          -- 2012 ~ 2015년 프로젝트 테이블 CTAS
        CREATE TABLE N06A_DRUG AS (  
        SELECT * FROM
        (SELECT * FROM DRUG_2012 
        UNION ALL
         SELECT * FROM DRUG_2013
         UNION ALL
          SELECT * FROM DRUG_2014_1
          UNION ALL
           SELECT * FROM DRUG_2014_2
            UNION ALL
            SELECT * FROM DRUG_2015
            UNION ALL
            SELECT * FROM DRUG_2015_2) A,
       (SELECT 
       "PRODUCT_NAME" , 
        "COMPANY_NAME" ,
        "DRUG_STD" , 
        "QTY" ,
        "DOSAGE_TYPE" , 
        "PACKING_TYPE" ,
        "PRODUCT_STD_CD" ,
        "PERMISSION_DATE" ,
        "NORMAL_OR_SPECIAL" ,
        "REPRESENT_CD" , 
        "STD_CD",
        "NEW_CD" ,  
        --"DRUG_INGREDIENT_CODE" ,
        "CANCEL_DATE",
        "TRANSFER_START_DATE" ,
        "TRANSFER_END_DATE" ,
        "SERIAL_YN" ,
        "SERIAL_REASON" ,
        "ATC_CD" ,
        "SPECIAL_CARE" ,
        "DECODE" 
       FROM BARCODEDATA WHERE aTC_CD LIKE 'N06A%' AND DRUG_INGREDIENT_CODE IS NOT NULL) B
        WHERE A.DRUG_INGREDIENT_CODE = B.DRUG_INGREDIENT_CODE) ;
        
        
          -- 2012 ~ 2015년 프로젝트 테이블 CTAS 수정
         CREATE TABLE N06A_DRUG AS (  
        SELECT * FROM
        (SELECT * FROM DRUG_2012 
         UNION ALL
         SELECT * FROM DRUG_2013
         UNION ALL
          SELECT * FROM DRUG_2014_1
          UNION ALL
           SELECT * FROM DRUG_2014_2
            UNION ALL
            SELECT * FROM DRUG_2015
            UNION ALL
            SELECT * FROM DRUG_2015_2) A,
       (SELECT 
       PRODUCT_NAME , 
      COMPANY_NAME ,
      DRUG_STD , 
      QTY ,
      DOSAGE_TYPE , 
      PACKING_TYPE ,
      PRODUCT_STD_CD ,
      PERMISSION_DATE ,
      NORMAL_OR_SPECIAL ,
      REPRESENT_CD , 
      STD_CD,
      NEW_CD ,  
      DRUG_INGREDIENT_CODE as DRUG_INGREDIENT_CODE2 ,
      CANCEL_DATE,
      TRANSFER_START_DATE ,
      TRANSFER_END_DATE ,
      SERIAL_YN ,
      SERIAL_REASON ,
      ATC_CD ,
      SPECIAL_CARE ,
      DECODE 
       FROM BARCODEDATA WHERE ATC_CD LIKE 'N06A%' 
       AND DRUG_INGREDIENT_CODE IS NOT NULL) B
        WHERE A.DRUG_INGREDIENT_CODE = B.DRUG_INGREDIENT_CODE2
        ) ;
        
        -- 뷰 만들기 
        create view N06A_DRUG_view AS (  
        SELECT * FROM
        (SELECT * FROM DRUG_2012 
         UNION ALL
         SELECT * FROM DRUG_2013
         UNION ALL
          SELECT * FROM DRUG_2014_1
          UNION ALL
           SELECT * FROM DRUG_2014_2
            UNION ALL
            SELECT * FROM DRUG_2015
            UNION ALL
            SELECT * FROM DRUG_2015_2) A,
       (SELECT 
       PRODUCT_NAME , 
      COMPANY_NAME ,
      DRUG_STD , 
      QTY ,
      DOSAGE_TYPE , 
      PACKING_TYPE ,
      PRODUCT_STD_CD ,
      PERMISSION_DATE ,
      NORMAL_OR_SPECIAL ,
      REPRESENT_CD , 
      STD_CD,
      NEW_CD ,  
      DRUG_INGREDIENT_CODE as DRUG_INGREDIENT_CODE2 ,
      CANCEL_DATE,
      TRANSFER_START_DATE ,
      TRANSFER_END_DATE ,
      SERIAL_YN ,
      SERIAL_REASON ,
      ATC_CD ,
      SPECIAL_CARE ,
      DECODE 
       FROM BARCODEDATA WHERE ATC_CD LIKE 'N06A%' 
       AND DRUG_INGREDIENT_CODE IS NOT NULL) B
        WHERE A.DRUG_INGREDIENT_CODE = B.DRUG_INGREDIENT_CODE2
        ) ;
        
        select * from n06a_drug_view;
        -- 샘플 아이디
        SELECT * FROM DRUG_2015 WHERE USER_ID = '662040';
        
        select * from n06a_drug_view;
        
        DROP TABLE DRUG_2015_ALL;
    
    create view N06A_DRUG_view0 AS (  
        SELECT A.DRUG_INGREDIENT_CODE FROM
        (SELECT * FROM DRUG_2012 
         UNION ALL
         SELECT * FROM DRUG_2013
         UNION ALL
          SELECT * FROM DRUG_2014_1
          UNION ALL
           SELECT * FROM DRUG_2014_2
            UNION ALL
            SELECT * FROM DRUG_2015
            UNION ALL
            SELECT * FROM DRUG_2015_2) A,
       (SELECT 
       PRODUCT_NAME , 
      COMPANY_NAME ,
      DRUG_STD , 
      QTY ,
      DOSAGE_TYPE , 
      PACKING_TYPE ,
      PRODUCT_STD_CD ,
      PERMISSION_DATE ,
      NORMAL_OR_SPECIAL ,
      REPRESENT_CD , 
      STD_CD,
      NEW_CD ,  
      DRUG_INGREDIENT_CODE as DRUG_INGREDIENT_CODE2 ,
      CANCEL_DATE,
      TRANSFER_START_DATE ,
      TRANSFER_END_DATE ,
      SERIAL_YN ,
      SERIAL_REASON ,
      ATC_CD ,
      SPECIAL_CARE ,
      DECODE 
       FROM BARCODEDATA WHERE ATC_CD LIKE 'N06A%' 
       AND DRUG_INGREDIENT_CODE IS NOT NULL) B
        WHERE A.DRUG_INGREDIENT_CODE = B.DRUG_INGREDIENT_CODE2
        );
        
        select * from N06A_DRUG_view0;
    
    -- N06A_DRUG2
    CREATE TABLE N06A_DRUG2  AS (  
        SELECT * FROM
        (SELECT * FROM DRUG_2012 
         UNION ALL
         SELECT * FROM DRUG_2013
         UNION ALL
          SELECT * FROM DRUG_2014_1
          UNION ALL
           SELECT * FROM DRUG_2014_2
            UNION ALL
            SELECT * FROM DRUG_2015
            UNION ALL
            SELECT * FROM DRUG_2015_2) A,
       (SELECT 
       PRODUCT_NAME , 
      COMPANY_NAME ,
      DRUG_STD , 
    --  QTY ,
    --  DOSAGE_TYPE , 
     -- PACKING_TYPE ,
    --  PRODUCT_STD_CD ,
    --  PERMISSION_DATE ,
      NORMAL_OR_SPECIAL ,
     -- REPRESENT_CD , 
     -- STD_CD,
     -- NEW_CD ,  
      DRUG_INGREDIENT_CODE as DRUG_INGREDIENT_CODE2 ,
     -- CANCEL_DATE,
      TRANSFER_START_DATE ,
     -- TRANSFER_END_DATE ,
      --SERIAL_YN ,
      --SERIAL_REASON ,
      ATC_CD 
     --SPECIAL_CARE ,
     -- DECODE 
       FROM BARCODEDATA WHERE ATC_CD LIKE 'N06A%' 
       AND DRUG_INGREDIENT_CODE IS NOT NULL) B
        WHERE A.DRUG_INGREDIENT_CODE = B.DRUG_INGREDIENT_CODE2
        ) ;
        
        -- N06A_DRUG_2015
         CREATE TABLE N06A_DRUG_2015  AS (  
        SELECT * FROM
        (
            SELECT * FROM DRUG_2015
            UNION ALL
            SELECT * FROM DRUG_2015_2) A,
       (SELECT 
       PRODUCT_NAME , 
      COMPANY_NAME ,
      DRUG_STD , 
    --  QTY ,
    --  DOSAGE_TYPE , 
     -- PACKING_TYPE ,
    --  PRODUCT_STD_CD ,
    --  PERMISSION_DATE ,
      NORMAL_OR_SPECIAL ,
     -- REPRESENT_CD , 
     -- STD_CD,
     -- NEW_CD ,  
      DRUG_INGREDIENT_CODE as DRUG_INGREDIENT_CODE2 ,
     -- CANCEL_DATE,
      TRANSFER_START_DATE ,
     -- TRANSFER_END_DATE ,
      --SERIAL_YN ,
      --SERIAL_REASON ,
      ATC_CD 
     --SPECIAL_CARE ,
     -- DECODE 
       FROM BARCODEDATA WHERE ATC_CD LIKE 'N06A%' 
       AND DRUG_INGREDIENT_CODE IS NOT NULL) B
        WHERE A.DRUG_INGREDIENT_CODE = B.DRUG_INGREDIENT_CODE2
        ) ;
         
         -- N06A_DRUG_2014
         CREATE TABLE N06A_DRUG_2014  AS (  
        SELECT * FROM
        (
            SELECT * FROM DRUG_2014_1
            UNION ALL
            SELECT * FROM DRUG_2014_2) A,
       (SELECT 
       PRODUCT_NAME , 
      COMPANY_NAME ,
      DRUG_STD , 
    --  QTY ,
    --  DOSAGE_TYPE , 
     -- PACKING_TYPE ,
    --  PRODUCT_STD_CD ,
    --  PERMISSION_DATE ,
      NORMAL_OR_SPECIAL ,
     -- REPRESENT_CD , 
     -- STD_CD,
     -- NEW_CD ,  
      DRUG_INGREDIENT_CODE as DRUG_INGREDIENT_CODE2 ,
     -- CANCEL_DATE,
      TRANSFER_START_DATE ,
     -- TRANSFER_END_DATE ,
      --SERIAL_YN ,
      --SERIAL_REASON ,
      ATC_CD 
     --SPECIAL_CARE ,
     -- DECODE 
       FROM BARCODEDATA WHERE ATC_CD LIKE 'N06A%' 
       AND DRUG_INGREDIENT_CODE IS NOT NULL) B
        WHERE A.DRUG_INGREDIENT_CODE = B.DRUG_INGREDIENT_CODE2
        ) ;
        
           CREATE view N06A_DRUG_2014  AS (  
        SELECT * FROM
        (
            SELECT * FROM DRUG_2014_1
            UNION ALL
            SELECT * FROM DRUG_2014_2) A,
       (SELECT 
       PRODUCT_NAME , 
      COMPANY_NAME ,
      DRUG_STD , 
    --  QTY ,
    --  DOSAGE_TYPE , 
     -- PACKING_TYPE ,
    --  PRODUCT_STD_CD ,
    --  PERMISSION_DATE ,
      NORMAL_OR_SPECIAL ,
     -- REPRESENT_CD , 
     -- STD_CD,
     -- NEW_CD ,  
      DRUG_INGREDIENT_CODE as DRUG_INGREDIENT_CODE2 ,
     -- CANCEL_DATE,
      TRANSFER_START_DATE ,
     -- TRANSFER_END_DATE ,
      --SERIAL_YN ,
      --SERIAL_REASON ,
      ATC_CD 
     --SPECIAL_CARE ,
     -- DECODE 
       FROM BARCODEDATA WHERE ATC_CD LIKE 'N06A%' 
       AND DRUG_INGREDIENT_CODE IS NOT NULL) B
        WHERE A.DRUG_INGREDIENT_CODE = B.DRUG_INGREDIENT_CODE2
        ) ;
        
        --
          CREATE view N06A_DRUG_2013  AS (  
        SELECT * FROM
        DRUG_2013 A,
       (SELECT 
       PRODUCT_NAME , 
      COMPANY_NAME ,
      DRUG_STD , 
    --  QTY ,
    --  DOSAGE_TYPE , 
     -- PACKING_TYPE ,
    --  PRODUCT_STD_CD ,
    --  PERMISSION_DATE ,
      NORMAL_OR_SPECIAL ,
     -- REPRESENT_CD , 
     -- STD_CD,
     -- NEW_CD ,  
      DRUG_INGREDIENT_CODE as DRUG_INGREDIENT_CODE2 ,
     -- CANCEL_DATE,
      TRANSFER_START_DATE ,
     -- TRANSFER_END_DATE ,
      --SERIAL_YN ,
      --SERIAL_REASON ,
      ATC_CD 
     --SPECIAL_CARE ,
     -- DECODE 
       FROM BARCODEDATA WHERE ATC_CD LIKE 'N06A%' 
       AND DRUG_INGREDIENT_CODE IS NOT NULL) B
        WHERE A.DRUG_INGREDIENT_CODE = B.DRUG_INGREDIENT_CODE2
        ) ;
        
        --
         CREATE view N06A_DRUG_2012 AS (  
        SELECT * FROM
        DRUG_2012 A,
       (SELECT 
       PRODUCT_NAME , 
      COMPANY_NAME ,
      DRUG_STD , 
    --  QTY ,
    --  DOSAGE_TYPE , 
     -- PACKING_TYPE ,
    --  PRODUCT_STD_CD ,
    --  PERMISSION_DATE ,
      NORMAL_OR_SPECIAL ,
     -- REPRESENT_CD , 
     -- STD_CD,
     -- NEW_CD ,  
      DRUG_INGREDIENT_CODE as DRUG_INGREDIENT_CODE2 ,
     -- CANCEL_DATE,
      TRANSFER_START_DATE ,
     -- TRANSFER_END_DATE ,
      --SERIAL_YN ,
      --SERIAL_REASON ,
      ATC_CD 
     --SPECIAL_CARE ,
     -- DECODE 
       FROM BARCODEDATA WHERE ATC_CD LIKE 'N06A%' 
       AND DRUG_INGREDIENT_CODE IS NOT NULL) B
        WHERE A.DRUG_INGREDIENT_CODE = B.DRUG_INGREDIENT_CODE2
        ) ;
    
     CREATE view N06A_DRUG_2015_VIEW  AS (  
        SELECT * FROM
        (
            SELECT * FROM DRUG_2015
            UNION ALL
            SELECT * FROM DRUG_2015_2) A,
       (SELECT 
       PRODUCT_NAME , 
      COMPANY_NAME ,
      DRUG_STD , 
    --  QTY ,
    --  DOSAGE_TYPE , 
     -- PACKING_TYPE ,
    --  PRODUCT_STD_CD ,
    --  PERMISSION_DATE ,
      NORMAL_OR_SPECIAL ,
     -- REPRESENT_CD , 
     -- STD_CD,
     -- NEW_CD ,  
      DRUG_INGREDIENT_CODE as DRUG_INGREDIENT_CODE2 ,
     -- CANCEL_DATE,
      TRANSFER_START_DATE ,
     -- TRANSFER_END_DATE ,
      --SERIAL_YN ,
      --SERIAL_REASON ,
      ATC_CD 
     --SPECIAL_CARE ,
     -- DECODE 
       FROM BARCODEDATA WHERE ATC_CD LIKE 'N06A%' 
       AND DRUG_INGREDIENT_CODE IS NOT NULL) B
        WHERE A.DRUG_INGREDIENT_CODE = B.DRUG_INGREDIENT_CODE2
        ) ;
        
        
        
        -- n06AB만 )
        SELECT COUNT(*) FROM (
          SELECT * FROM
        (
            SELECT * FROM DRUG_2015
            UNION ALL
            SELECT * FROM DRUG_2015_2) A,
       (SELECT 
       PRODUCT_NAME , 
      COMPANY_NAME ,
      DRUG_STD , 
    --  QTY ,
    --  DOSAGE_TYPE , 
     -- PACKING_TYPE ,
    --  PRODUCT_STD_CD ,
    --  PERMISSION_DATE ,
      NORMAL_OR_SPECIAL ,
     -- REPRESENT_CD , 
     -- STD_CD,
     -- NEW_CD ,  
      DRUG_INGREDIENT_CODE as DRUG_INGREDIENT_CODE2 ,
     -- CANCEL_DATE,
      TRANSFER_START_DATE ,
     -- TRANSFER_END_DATE ,
      --SERIAL_YN ,
      --SERIAL_REASON ,
      ATC_CD 
     --SPECIAL_CARE ,
     -- DECODE 
       FROM BARCODEDATA WHERE ATC_CD LIKE 'N06AB%' 
       AND DRUG_INGREDIENT_CODE IS NOT NULL) B
        WHERE A.DRUG_INGREDIENT_CODE = B.DRUG_INGREDIENT_CODE2 );
        
        select * from N06A_DRUG_2015 where atc_cd like 'N06AB%';
        
        select * from N06A_DRUG_2015 where sex='3';
        
        select count(*) from barcodedata;
        
        select product_name, COUNT(product_name) from N06A_DRUG_2015 where atc_cd like 'N06AB%' group by product_name ORDER BY COUNT(product_name) DESC ;